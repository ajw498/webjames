<html>
<head>
  <title>WebJames - the web server</title>
</head>

<body bgcolor="#ffffff">
<table bgcolor="#aaaaaa" width="99%"><tr>
<td><center>
<h1>
WebJames - the web server
</h1>
</center>
</td></tr>
<tr>
<td><center><h5>
Version 0.26
</h5></center>
</td>
</tr></table>

<h5><center>Contents</center></h5>
<ul>
<li><a href="#intro">Introduction</a><br>
<li><a href="#install">Installation</a><br>
<li><a href="#yoursite">Your site</a><br>
<li><a href="#config">Configuration</a><br>
<li><a href="#attr">Attributes</a><br>
<li><a href="#cgi">CGI scripts</a><br>
<li><a href="#putdelete">PUT and DELETE methods</a><br>
<li><a href="#log">Logging/statistics</a><br>
<li><a href="#bandwidth">Bandwidth</a><br>
<li><a href="#commands">Commands</a><br>
<li><a href="#cache">Cache</a><br>
<li><a href="#reports">Reports</a><br>
<li><a href="#missing">Things that need to be improved</a><br>
<li><a href="#history">History</a><br>
<li><a href="#notes">Notes</a><br>
</ul>


<p>
<h3>
<table bgcolor="#cccccc" width="99%"><tr><td>
<a name="intro">Introduction</a>
</td></tr></table>
</h3>

  <p>
  WebJames is a freeware HTTP server for RISC OS.<br>
This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 2 of the License, or
(at your option) any later version.
<p>
This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.
<p>
You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.

 <p>
  Versions 0.24 and earlier were written by Henrik Bjerregaard Pedersen<br>
  email: <a href="mailto:henrik@login.dknet.dk">henrik@login.dknet.dk</a><br>
  www: <a href="http://login.dknet.dk/~henrik/">http://login.dknet.dk/~henrik/</a>
 <p>
  Development has now been taken over by Alex Waugh<br>
  email: <a href="mailto:ajw498@ecs.soton.ac.uk">ajw498@ecs.soton.ac.uk</a><br>
  www: <a href="http://www.ecs.soton.ac.uk/~ajw498/">http://www.ecs.soton.ac.uk/~ajw498/</a>

 <p>
  The source has been released in the hope that others will improve and
 extend the program.



<p>
<h3>
<table bgcolor="#cccccc" width="99%"><tr><td>
<a name="install">Installation</a>
</td></tr></table>
</h3>

 <p>
 <h5>Installing this version from scratch</h5>

  To get things up and running, you will need to have an internet stack
 running. If you use the ANT suite, then you will need to ensure that
 local loopback is enabled. If it is not, then in the ANT configuration
 program, tick the LAN icon, then open the LAN setup window. Select
 <code>Loopback</code>
 from the driver list. Host name should be <code>localhost</code> and
 IP address <code>127.0.0.1</code> IP Mask <code>255.255.255.0</code> and
 leave Name server blank.
 <p>
  The Acorn stack has loopback configured on by default.
 <p>
  You will also need the MimeMap module version 0.10 or later. If you
 don't have this then download it from <a href="http://www.movspclr.co.uk">
 http://www.movspclr.co.uk</a> and put it in !System.310.Modules.Network
 <p>
  Copy WebJames to a suitable location on your harddisc or wherever you
 may want to install it. Start WebJames by double-clicking on its icon.
 No icon will apear on the iconbar, but you can check that it is running
 by seeing if it is listed in the Task manager.
 <p>
  Check that your web browser is not set up to use a proxy server. If it is,
 then you will have to turn it off, or add localhost to the list of domains
 to exclude. You will not be able to run !WebServe on the same machine unless
 you set WebServe or WebJames to use different ports from each other. 
 <p>
  In your web browser, enter the URL <a href="http://localhost/">
 http://localhost/<a>, and you should get a page saying that WebJames
 is working.
 <p>
  You can now put your web pages in the <code>Site</code> directory
 or edit the <a href="#config">config file</a> to give the location of the pages.
 You should also change the webmaster email address and if possible server ip
 address in the <a href="#config">config file</a>.
 <p>
  The rest of the <a href="#config">config file</a>, and the <a href="#attr">
 attributes file</a> can be edited to suit your requirements, but the default
 values should be suitable to start with.  


 <p>
 <h5>Installing this version on top of an older version</h5>

  Go through all the steps in the table below and perform those that
 match the version you're installing the new version on top of.
  <em>This may overwrite log-files, configuration files, report templates
 and part of your website.</em>

 <p>
 <table border="1">
 <col span="1" width="90">

 <tr>
 <th span="1">Version</th>
 <th span="1">&nbsp;</th>
 </tr>

 <tr>
 <td valign="top">0.01-0.09</td>
 <td>shut down WebJames (from the task manager)</td>
 </tr>

 <tr>
 <td valign="top">0.01-0.23</td>
 <td>copy the new version to the directory where WebJames resides, thus
     overwriting the old version</td>
 </tr>

 <tr>
 <td valign="top">0.01-0.23</td>
 <td>edit the <a href="#attr">attributes file</a> and the config file
     (if necessary)</td>
 </tr>

 <tr>
 <td valign="top">0.01-0.09</td>
 <td>restart WebJames by double-clicking on the !WebJames icon</td>
 </tr>

 <tr>
 <td valign="top">0.10-0.23</td>
 <td>double-click on the !WebJames icon to kill the old
     version and start the new</td>
 </tr>

 </table>



<p>
<h3>
<table bgcolor="#cccccc" width="99%"><tr><td>
<a name="yoursite">About your site</a>
</td></tr></table>
</h3>

  The web site to be served by WebJames is usually stored in a single
 directory, and may hold any number of files and subdirectories. The path
 to the directory is set in the <a href="#config">config file</a>, which
 usually is <code>&lt;WebJames$Dir&gt;.config</code>.

 <p>
  The filepaths in incoming request will use unix-syntax instead of RISC OS
 syntax, so WebJames will switch / and . so the URI <code>/pics/file.gif</code>
 will refer to the file <code>pics.file/gif</code>.

 <p>
  If a request for a directory is received, WebJames will append
 the name of a default file (usually <code>index.html</code>) to the URI;
 thus a request for the URI <code>/whatever/</code> will usually return
 the file <code>whatever.index/html</code>. The name of the default file
 is an <a href="#attr">attribute</a> of the directory, and so may be changed
 by editing the <i>attributes</i> file.



<p>
<h3>
<table bgcolor="#cccccc" width="99%"><tr><td>
<a name="config">Configuration</a>
</td></tr></table>
</h3>

  The name of the config file is passed to WebJames as the first argument
 when WebJames is started. Usually the config file is
 <code>&lt;WebJames$Dir&gt;.config</code>.

 <p>
  The config file holds information about the location (on your harddisc)
 of your website, the location of various database files, the maximum
 network-bandwidth WebJames may use, port number (usually 80), log-files
 etc. See the configuration file for details of the various options.

 <p>
  There are rather a lot of options in the config file, but usually you
 will only need to edit the first field - the webmaster-email-address.



<p>
<h3>
<table bgcolor="#cccccc" width="99%"><tr><td>
<a name="attr">Attributes</a>
</td></tr></table>
</h3>

  The path to the 'attributes' database file is set in the 
 <a href="#config">config file</a>; it is usually
 <code>&lt;WebJames$Dir&gt;.attributes</code>.

 <p>
  The 'attributes' database defines attributes for any number of
 URIs/files/directories. Attributes are things like <i>cacheability</i>,
 <i>redirection</i>, <i>password-protection</i>, <i>cgi-script API</i> and
 more. <i>Realms</i> are also defined in the 'attributes' file.

 <p>
  It is considered an attribute of a file that it may be executed as a
 cgi-script; therefore, the name of the directory (or directories) that
 hold cgi-scripts is defined in the 'attributes' file rather than in the
 <a href="#config">config file</a>.

 <p>
  Attributes defined for a directory (eg. <code>/cgi-bin/</code>) apply to
 all files inside the directory; however, you may also define attributes
 for a single file or redefine attributes for files/URIs that have
 attributes defined elsewhere in the attributes file.

 <p>
  An attributes file consists of a number of sections, each section defines
 attributes for a file or directory.
 A section starts with <code>&lt;location /uri/&gt;</code> and finished with
 <code>&lt;/location&gt;</code>.

 <p>
  If the URI ends in a <code>/</code>, it refers to a directory and all the
 files inside the directory; otherwise it refers to a file. The URI <b>must</b>
 start with a <code>/</code>.

 <p>
  The following fragment of an attributes file password-protects the
 <code>/private/</code> directory and all of its contents except the file
 <code>/private/busy.html</code>, and redirects the URI
 <code>/linux.html</code> to <code>http://www.linuxberg.com/</code> and
 also causes all request for URIs starting with <code>/~xyz/</code> to
 access a directory in the RAM disc and ensures that files in that
 directory will never be cached.<br>
  However, first of all it defines the <code>cgi-bin</code> directory.


 <pre>
 # select the cgi-bin directory
 &lt;location /cgi-bin/&gt;
 is-cgi
 &lt;/location&gt;

 # password-protect (almost) everything in /private/
 &lt;location /private/&gt;
 userandpwd=myname:mypassword
 realm=privateparts
 &lt;/location&gt;
 # don't password-protect /private/busy.html, so just
 # set the password to &lt;empty&gt;
 &lt;location /private/busy.html&gt;
 userandpwd=
 &lt;/location&gt;

 # redirect /linux.html requests to www.linuxberg.com
 &lt;location /linux.html&gt;
 moved=http://www.linuxberg.com/
 &lt;/location&gt;

 # move /~xyz/ requests to the RAM disc, and don't
 # cache the contents of the RAM disc...
 &lt;location /~xyz/&gt;
 homedir=RAM:$.WebSite
 notcacheable
 &lt;/location&gt;

 # enable PUT-requests for the cgi-script that handles
 # PUT-requests
 #&lt;location /cgi-bin/PUT&gt;
 #methods="PUT"
 #&lt;/location&gt;

 # make private directory for 192.168.1.100
 &lt;location /private/johndoe/&gt;
 allowed-hosts=192.168.1.100
 &lt;/location&gt;
 </pre>

 <p>
  Please notice - you can only set a home-directory for
 <em>directories</em> - NOT for files (eg. for <code>/~xyz/</code> but
 not for <code>/~xyz/pi.gif</code>).

 <p>
  You can also create sections for specific directories using
 <code>&lt;directory ADFS::4.$.Dir&gt;</code> and <code>&lt;/directory&gt;</code>
 The attributes within such a section will apply to anything fetched from
 that directory, whatever the URI was.
 <p>
  Attributes in a <code>&lt;directory&gt;</code> section take precedence over
 those in a <code>&lt;location&gt;</code> section.

 <p>
  Old style [/uri/] sections still work.

 <p>

 <h5><center>The full list of attributes</center></h5>

 <p>
  Below is the full list of attributes currently supported.

 <p>

 <table border="1" width="99%">
 <col span="1" width="150">

 <tr>
 <td><code>cgi-api</code></td>
 <td>this attribute tells WebJames how to start the cgi-script; allowed
     values are <code>redirect</code> and <code>webjames</code>; default
     is <code>webjames</code><br>
     example: <code>cgi-api=redirect</code></td>
 </tr>

 <tr>
 <td><code>is-cgi</code></td>
 <td>allows the file (or all files in the directory) to be executed
     as a cgi-script(s)</td>
 </tr>

 <tr>
 <td><code>isnt-cgi</code></td>
 <td>when included, the file (or the contents of the directory) may
     not be executed as a cgi-script - this is obviously the default</td>
 </tr>

 <tr>
 <td><code>notcacheable</code></td>
 <td>makes a file (or the contents of a directory) non-cacheable</td>
 </tr>

 <tr>
 <td><code>cacheable</code></td>
 <td>makes a file/directory cacheable (default) </td>
 </tr>

 <tr>
 <td><code>homedir</code></td>
 <td>sets the path to the directory where part of the website is stored;
     default is the value of <code>homedir</code> in the <a href="#config">
     config file</a><br>
     example: <code>homedir=RAM:$.oftenused</code></td>
 </tr>

 <tr>
 <td><code>userandpwd</code></td>
 <td>sets the username and password for a file or directory - the format
     is <code>username:password</code><br>
     example: <code>userandpwd=henrik:mypassword</code></td>
 </tr>

 <tr>
 <td><code>accessfile</code></td>
 <td>the file holds a list of username:password pairs<br>
     example: <code>accessfile=&lt;WebJames$Dir&gt;.cgi-res.access0</code>
     </td>
 <tr>

 <tr>
 <td><code>realm</code></td>
 <td>sets the name of the realm to which a password-protected
     file/directory belongs<br>
     example: <code>realm='search engine'</code></td>
 </tr>

 <tr>
 <td><code>moved</code></td>
 <td>requests for the URI will result in a respons which redirects the
     requesting browser to the new URI<br>
     example: <code>moved=http://www.xyz.com/</code></td>
 </tr>

 <tr>
 <td><code>tempmoved</code></td>
 <td>requests for the URI will result in a respons which redirects the
     requesting browser to the new URI - should be used if the file has
     only been moved temporarily<br>
     example: <code>moved=http://www.xyz.com/</code></td>
 </tr>

 <tr>
 <td><code>methods</code></td>
 <td>this attribute tells WebJames which request-methods are allowed for
     the URI - the value is a comma-seperated list of the allowed methods,
     default is 
     <code>&quot;GET&quot;,&quot;HEAD&quot;,&quot;POST&quot;</code>,
     ie. <code>PUT</code> and <code>DELETE</code> are disabled<br>
     example: <code>methods=&quot;POST&quot;,&quot;HEAD&quot;</code>
     </td>
 </tr>

 <tr>
 <td><code>port</code></td>
 <td>this attribute tells WebJames which portnumber requests for the
     URI may be accepted on; if WebJames is configured to listen on
     multiple ports, this attribute can be used to hide the URI from
     incoming requests on all ports except one<br>
     example: <code>port=80</code></td>
 </tr>

 <tr>
 <td><code>allowed-hosts</code></td>
 <td>this attribute lists the ip-addresses of all the hosts that are
     allowed to access the URI; the value is a comma-seperated list of
     ip-addresses - you may have multiple <code>allowed-hosts</code>-lines
     for an URI; default is everybody<br>
     example: <code>allowed-hosts=192.168.1.100,192.168.1.101</code></td>
 </tr>

 <tr>
 <td><code>forbidden-hosts</code></td>
 <td>this attribute lists the ip-addresses of all the hosts that aren't
     allowed to access the URI; default is nobody</td>
 </tr>

 <tr>
 <td><code>priority</code></td>
 <td>this attribute controls how fast the respons will be returned to the
     requesting browser; the first value is the priority level - from 0
     (lowest priority) to 100 (highst priority), the second value is
     optional - if present it sets the max no. of bytes per second to
     transmit when replying, 0 means no limit; default values are 100 and
     0; the <code>priority</code>-attribute may be ignored by WebJames<br>
     example: <code>priority=25,10000</code></td>
 </tr>

 <tr>
 <td><code>ram-faster</code></td>
 <td>when this attribute is set for a cgi-script, WebJames is <i>allowed</i>
     to move the cgi-script to/from a faster filing-system (eg. RAM disc)
     whenever it is considered beneficial</td>
 </tr>

 <tr>
 <td><code>more-attributes</code></td>
 <td>this attribute specifies the name of a file containing additional
     attributes; if the <code>more-attributes</code> appears inside an
     URI-section, the URIs in the file are considered relative to the
     URI for the section in parent-file<br>
     example: <code>more-attributes=&lt;WebJames$Dir&gt;.Site-Info.Attr1</code>
     </td>
 </tr>

 <tr>
 <td><code>defaultfile</code></td>
 <td>this attribute lists the names of the files to look for if the remote
     host requests a directory, eg. <code>GET / HTTP/1.0</code>; the list is
     searched from left to right, and the first matching file found is returned;
     this attribute can only be set for directories, not files!!<br>
     example: <code>defaultfile=index.php,index.html</code>
     </td>
 </tr>

 <tr>
 <td><code>hidden</code></td>
 <td>when set, the file (or the contents of the directory) cannot be
     accessed</td>
 </tr>

 <tr>
 <td><code>nothidden</code></td>
 <td>when set, the file (or the contents of the directory) <em>can</em>
     be accessed; this attribute is mainly useful for enabling access to
     files that are stored in a directory which has the <code>hidden</code>
     attribute set</td>
 </tr>

 <tr>
 <td><code>allowed-filetypes</code></td>
 <td>this attribute lists the filetypes that may be treated as cgi-scripts;
     the value is a comma-seperated list of filetypes in hexadecimal
     - you may have multiple <code>allowed-filetypes</code>-lines
     for an URI; default is all filetypes; a blank list means all filetypes<br>
     note: this only affects files that have the <code>is-cgi</code> attribute set; files
     that have the <code>isnt-cgi</code> attribute will never be treated as cgi-scripts
     regardless of their filetype<br>
     example: <code>allowed-filetypes=18A,102,FFB</code></td>
 </tr>

 <tr>
 <td><code>forbidden-filetypes</code></td>
 <td>this attribute lists the filetypes that may not be treated as cgi-scripts;
     the value is a comma-seperated list of filetypes in hexadecimal
     - you may have multiple <code>forbidden-filetypes</code>-lines
     for an URI; default is no filetypes are forbidden; a blank list means no filetypes; if a filetype is listed
     in both the <code>allowed-filetypes</code> list and the <code>forbidden-filetypes</code>
     list then the forbidden list takes priority<br>
     example: <code>forbidden-filetypes=FAF,FFF,695,C85</code></td>
 </tr>

 <tr>
 <td><code>errordocument</code></td>
 <td>this attribute allows error messages to be customised for individual directories.
     the first parameter is the http status code that the error message refers to. the second
     parameter is either a <code>&quot;</code> character followed by the text to send, or
     a URI to redirect to.
     you may have multiple <code>errordocument</code> lines for an URI, provided
     their status codes are different<br>
     example: <code>errordocument 404 &quot;&lt;HTML&gt;&lt;BODY&gt;Sorry, this file was not found&lt;/BODY&gt;&lt;HTML&gt;</code><br>
     example: <code>errordocument 403 /forbidden.html</code><br>
     example: <code>errordocument 500 http://www.somewhere.com/</code><br>

     </td>
 </tr>
 <td><code>stripextensions</code></td>
 <td>this attribute strips the filename extensions from URIs before looking for the file.
     this includes the default files if a directory is requested, and any errordocument files as well.<br>
     example: a request of <code>/wibble.html</code> would return the file <code>wibble</code>

     </td>
 </tr>

 </table>


 <p>

 <h5>Nested attribute-files</h5>

  The <code>more-attributes</code> attribute allows you to have nested
 attribute-files; eg. if multiple sites are served by the server, the
 attributes for each site may have its attributes defined in a seperate
 file.

 <p>
  Example: assuming the users <code>joe</code> and <code>bob</code> both
 have their web-site on your server; the main attributes-file could then
 look like this:

 <pre>
 # main attributes file
 &lt;location /~joe/&gt;
 more-attributes=&lt;WebJames$Dir&gt;.sites.joe.~attributs
 &lt;/location&gt

 &lt;location /~bob/&gt;
 more-attributes=&lt;WebJames$Dir&gt;.sites.bob.~attributs
 &lt;/location&gt
 </pre>

 The attributes-file (<code>&lt;WebJames$Dir&gt;.sites.joe.~attributs</code>)
 could then look something like this:

 <pre>
 # attributes file for joe
 # all URIs in &lt;location&gt; are relative to /~joe/

 # set the base-directory for joe's site
 &lt;location /&gt;
 homedir=&lt;WebJames$Dir&gt;.sites.joe
 &lt;/location&gt

 # hide the attributes file for joe's site
 &lt;location /~attributs&gt;
 hidden
 &lt;/location&gt
 </pre>

  All requests for URIs starting with <code>/~joe/</code> would then access
 files in the <code>&lt;WebJames$Dir&gt;.sites.joe</code> directory; notice
 that the attribute-file for joe's site itself is stored inside joe's
 site-directory; this would be a security risk, if the file hadn't been
 marked inaccessible (by the <code>hidden</code> attribute).

 <p>
 Notice - you should not nest attribute-files in more than 3 levels.

 <h5>htaccess files</h5>

  You can also specify attributes for a directory by putting them in an
 <code>htaccess</code> file within the directory. The name of the <code>htaccess</code>
 file is specified in the <a href="#config">config file</a>, and is by default
 <code>/htaccess</code>

 <p>
  The <code>htaccess</code> files are in the same format as the attributes file,
 but act as if the whole file was surrounded by a <code>&lt;directory dirname&gt;</code>
 section, where dirname is the directory the <code>htaccess</code> file is in.

 <p>
  Please note that the <code>htaccess</code> files are cached, so if you alter one,
 then it may not take effect until you restart WebJames.

<p>
<h3>
<table bgcolor="#cccccc" width="99%"><tr><td>
<a name="cgi">CGI scripts</a>
</td></tr></table>
</h3>

  Any file (or the contents of any directory) which has the
 <code>is-cgi</code> <a href="#attr">attribute</a> set, can be executed
 as a cgi-script.

 <p>
  An incoming request for a file which is a cgi-script, causes WebJames
 to attempt to run that file, rather than reading the file and returning
 it to the client.

 <p>
  WebJames supports two different types of cgi-scripts - <i>redirect</i>
 or <i>webjames-style</i>.

 <p>
  Confusing these is likely to cause trouble; it is therefore recommended
 that <i>redirect</i> cgi-scripts are stored in a directory called
 <i>/cgi-bin2/</i> while <i>webjames-style</i> cgi-scripts are stored in
 a directory called <i>/cgi-bin/</i>.


 <p>
  All cgi-scripts are treated as <i>webjames-style</i>, unless the
 <i>cgi-api</i> <a href="#attr">attribute</a> for the cgi-script is set 
 to <i>redirect</i> in the <a href="#attr">attributes file</a>.


 <h6>redirect</h6>

  When a cgi-script of this type is executed, all output from the script
 is redirected to a temporary file; when the script exits, WebJames reads
 the file and returns it to the host requesting the file.

 <p>
  When the request is a <code>POST</code>-request, the cgi-script can read
 the request-body from the standard input.

 <p>
  Scripts may not multitask, or use the BASIC/C cgi-lib included with
 WebJames, and there is currently no provision for the script to read
 information about the request other than the information stored in the
 following system variables:

 <table>
 <col span="1" width="150">

 <tr>
 <td valign="top"><code>QUERY_STRING</code></td>
 <td>the arguments-part of the request-URI; if the URI is
     <code>/cgi-bin2/find?whereis=Waldo</code>, <code>QUERY_STRING</code>
     will contain <code>whereis=Waldo</code></td>
 </tr>

 <tr>
 <td><code>PATH_TRANSLATED</code></td>
 <td>name of the cgi-script, eg. <code>&lt;WebJames$Dir&gt;.site.cgi-bin2.test</code></td>
 </tr>

 <tr>
 <td><code>SCRIPT_NAME</code></td>
 <td>uri of the script without the hostname, eg. <code>/cgi-bin2/test.php</code></td>
 </tr>

 <tr>
 <td><code>CONTENT_LENGTH</code></td>
 <td>size of the request-body - only valid for <code>POST</code> and
     <code>PUT</code> requests</td>
 </tr>

 <tr>
 <td><code>CONTENT_TYPE</code></td>
 <td>request-body MIME-type - only valid for <code>POST</code> and
     <code>PUT</code> requests</td>
 </tr>

 <tr>
 <td><code>REQUEST_METHOD</code></td>
 <td>either <code>GET</code>, <code>HEAD</code>, <code>POST</code>,
     <code>PUT</code> or <code>DELETE</code></td>
 </tr>

 <tr>
 <td valign="top"><code>REMOTE_ADDR</code></td>
 <td>the IP-address of the host requesting the file, eg.
     <code>192.168.1.80</code></td>
 </tr>


 <tr>
 <td valign="top"><code>AUTH_TYPE</code></td>
 <td>set to the authentication method used, if the cgi-script is password
     protected</td>
 </tr>

 <tr>
 <td valign="top"><code>REMOTE_USER</code></td>
 <td>name of remote user - only set if authentication was used</code>
     protected.</td>
 </tr>


 <tr>
 <td valign="top"><code>HTTP_USER_AGENT</code></td>
 <td>contents of the <code>User-Agent:</code> field in the request</td>
 </tr>

 <tr>
 <td valign="top"><code>HTTP_REFERER</code></td>
 <td>contents of the <code>Referer:</code> field in the request</td>
 </tr>

 <tr>
 <td valign="top"><code>HTTP_COOKIE</code></td>
 <td>contents of the <code>Cookie:</code> field in the request</td>
 </tr>


 <tr>
 <td valign="top"><code>SERVER_SOFTWARE</code></td>
 <td>the name/versionnumber set by the <code>server</code>-field in the
     <a href="#config">config file</a>, eg <code>Webjames/0.15</code></td>
 </tr>

 <tr>
 <td valign="top"><code>SERVER_PORT</code></td>
 <td>the port number set by the <code>port</code>-field in the
     <a href="#config">config file</a></td>
 </tr>

 <tr>
 <td valign="top"><code>SERVER_PROTOCOL</code></td>
 <td>usually <code>HTTP/1.0</code></td>
 </tr>

 <tr>
 <td valign="top"><code>SERVER_ADMIN</code></td>
 <td>email-address of the server-administrator - set by the
     <code>webmaster</code>-field in the <a href="#config">config
     file</a></td>
 </tr>

 <tr>
 <td valign="top"><code>SERVER_NAME</code></td>
 <td>the ip-address or fully qualified domain anme of the server - as set
     by the <code>serverip</code>-field in the <a href="#config">config
     file</a></td>
 </tr>


 <tr>
 <td valign="top"><code>ENTITY_PATH</code></td>
 <td>the name of entity/URI that is being put or deleted - only valid for
     <code>PUT</code> and <code>DELETE</code> requests; example: if the
     request-line is
           <br><code>PUT /upload/pam.jpg HTTP/1.0</code><br>
     the value of <code>ENTITY_PATH</code> will be
     <code>/upload/pam.jpg</code>
 </td>
 </tr>


 </table>


 <h6>webjames-style</h6>

  The cgi-script is run with the following arguments:

 <dl>
 <dt><code>-socket N</code>
 <dd>socket to output data on
 <dt><code>-port N</code>
 <dd>portnumber used by the server

 <dt><code>-http version</code>
 <dd>http version * 10 (eg. 11 for HTTP/1.1)

 <dt><code>-head</code>
 <dd>if the request was a <code>HEAD</code> request
 <dt><code>-post</code>
 <dd>if the request was a <code>POST</code> request
 <dt><code>-put</code>
 <dd>if the request was a <code>PUT</code> request
 <dt><code>-delete</code>
 <dd>if the request was a <code>DELETE</code> request

 <dt><code>-rma address</code>
 <dd>address in RMA of a block of memory holding the entire request
     (header and all); the content of the block is not necessarily 100% 
     identical to the request; lines may have been added, removed,
     joined or altered; also lines are terminated by a single
     <code>LF</code>
 <dt><code>-file filename</code>
 <dd>instead of storing the header in shared memory, WebJames may choose
     to save it to disc
 <dt><code>-dynamic no</code>
 <dd>instead of storing the header in a file or in the RMA, WebJames may
     choose to store it in a dynamic area, and simply inform the
     CGI-script of the number of the dynamic area

 <dt><code>-size bytes</code>
 <dd>size of the -rma block or -dynamic area
 <dt><code>-remove</code>
 <dd>if included, the CGI-script should delete the -file file or release
     the -rma block or remove the -dynamic area

 <dt><code>-bps N</code>
 <dd>maximum bandwidth (in bytes/second) to use; if 0, there's no limit
     [<i>optional</i>]
 <dt><code>-host a.b.c.d</code>
 <dd>the IP-address of the client [<i>optional</i>]
 <dt><code>-host hostname</code>
 <dd>the hostname of the client [<i>optional</i>]

 <dt><code>-user username</code>
 <dd>if the cgi-script is password-protected, this indicates the username
     used to get access to the cgi-script
 </dl>

 Please notice:
 <ul>
 <li>if neither <code>-head</code>, <code>-post</code>, <code>-put</code>
     nor <code>-delete</code> is included, it is a <code>GET</code> request
 <li>only one of <code>-rma</code>, <code>-file</code> and
     <code>-dynamic</code> can be present
 </ul>

 <p>
  CGI-scripts should only store the actual CGI-script-code (or an obey-file
 that calls the actual CGI-script-code) in the cgi-bin directory. All other
 files (database files, graphics etc.) should be stored outside the site-
 directory, preferably in <code>&lt;WebJames$Dir&gt;.cgi-res</code>.
  This is because any file in the cgi-bin directory may be run by a
 suitable request.

 <p>
  <code>&lt;WebJames$Dir&gt;.cgi-lib</code> is a BASIC library which
 hopefully makes it much, much easier for BASIC programmers to write
 CGI-scripts. It provides routines to send files, handle very long
 strings, parsing arguments, multitasking etc.

 <p>
  There is a relatively large overhead involved in starting a cgi-script,
 especially cgi-scripts that load large databases or open many files. It
 may be beneficially to write such scripts so that they are multitasking
 application that lie dormant until a smaller script invokes them, eg. by
 broadcasting a Wimp-message.



<p>
<h3>
<table bgcolor="#cccccc" width="99%"><tr><td>
<a name="putdelete">PUT and DELETE</a>
</td></tr></table>
</h3>

  When WebJames receives a <code>PUT</code> or <code>DELETE</code> request,
 it treats it as if it was a request for the file or cgi-script defined by
 the <code>put-script</code> or <code>delete-script</code> field in the
 <a href="#config">config file</a>.

 <p>
  If the request is for a 'redirected' cgi-script, the script will be
 started as usual, and can read the body of the request (if it was a
 <code>PUT</code> request) from the standard input, and should output the
 respons to the standard output - the name of the URI that is being
 attempted to <code>PUT</code> or <code>DELETE</code> is stored in the
 variable <code>ENTITY_PATH</code>.

 <p>
  <i>Please notice:</i> the default value of the
 <code>methods</code>-attribute disallows <code>PUT</code> and
 <code>DELETE</code> requests - you will have to manually enable these
 methods in the <a href="#attr">attributes-file</a>.

 <p>
  <strong>Supporting <code>PUT</code> and <code>DELETE</code> can be a 
 security risk -  you should not enable it unless you have to, and you
 should ALWAYS password-protect the scripts and only enable the
 <code>PUT</code> and <code>DELETE</code> methods for those scripts.
 </strong>


<p>
<h3>
<table bgcolor="#cccccc" width="99%"><tr><td>
<a name="log">Logging/statistics</a>
</td></tr></table>
</h3>

  Logging is enabled by specifying a log file in the <a href="#config">
 config file</a>.

 <p>
  CGI-scripts (and other applications) may write to the log by use of the
 command <code>log</code>.<br>
  When compiling WebJames, the following options control the log:

 <p>
 <dl>
 <dt><code>LOG</code>
 <dd>must be defined to allow logging
 <dt><code>SYSLOG</code>
 <dd>if defined, log data will be written to <code>SysLog</code> instead
     of to the file set in the <a href="#config">config file</a>
 </dl>


 <p>
  The <code>CLF</code> (<code>Common Logfile Format</code>) logfile
 contains info about all received requests. The <code>CLF</code> format
 is used by many web-servers, including <i>Apache</i>.

 <p>
  The name of the <code>CLF</code> logfile is set in the <a href="#config">
 config file</a>.

 <p>
  The <code>CLF</code> logfile (and the normal log file) is kept open
 for a few minutes after a write to the file, to eliminate the overhead
 incurred by opening/closing the files.

 <p>
  Both log files may be rotated when they become too old or too big; this
 is controlled in the <a href="#config">config file</a>. Rotation is
 performed by executing a command which is also defined in the config file.
 Instead of simply renaming the logfile, you may use a command like
 <code>Squash</code> or <code>ZipCompress</code> to compress the file -
 log files usually compress to 25% or less of their original size.


<p>
<h3>
<table bgcolor="#cccccc" width="99%"><tr><td>
<a name="bandwidth">Bandwidth</a>
</td></tr></table>
</h3>

  If you're on a slow network (eg. modem) you may not want replies to
 incoming requests to use more than a fraction of the bandwidth.

 <p>
  For a 33k6 modem, the maximum bandwidth is approx. 240000 bytes/min.<br>
 To force WebJames to use max 1/3rd of this, set bandwidth to
 240000/3 = 80000 bytes/min in the <a href="#config">config file</a>.

 <p>
  If the maximum bandwidth is set to 0, WebJames will use as much bandwidth
 as possible.

 <p>
  WebJames calculates the bandwidth-usage as a mean of the number of bytes
 written to the network over the last 1-2 minutes.


<p>
<h3>
<table bgcolor="#cccccc" width="99%"><tr><td>
<a name="commands">Commands</a>
</td></tr></table>
</h3>

  Other applications may give commands to WebJames, eg. to force WebJames to
 flush the cache.

 <p>
  Commands are sent using wimp-message <code>&4f988</code>
   (<code>MESSAGE_WEBJAMES_CMD</code>):

 <p>
 <table width="99%" border="1">
 <colgroup span="1" width="60" align="center">
 <colgroup span="1" width="80">
 <colgroup span="1">
 <tr>
   <th>Offset</th>
   <th>Contents</th>
   <th>Meaning</th>
 </tr>
 <tr>
   <td>0</td>
   <td>N</td>
   <td>message size in bytes</td>
 </tr>
 <tr>
   <td>16</td>
   <td>&4f988</td>
   <td>message number, always &4f988</td>
 </tr>
 <tr valign="top">
   <td>20</td>
   <td>flags</td>
   <td>
     <table>
     <colgroup span="1" width="40">
     <colgroup span="1" width="20">
     <colgroup span="1">
     <tr valign="top">
       <td>bit 0</td>
       <td>0</td>
       <td>command/message to WebJames</td>
     </tr>
     <tr valign="top">
       <td></td>
       <td>1</td>
       <td>reply/message from WebJames</td>
     </tr>
     <tr valign="top">
       <td>bit 1</td>
       <td>0</td>
       <td>normal message</td>
     </tr>
     <tr valign="top">
       <td></td>
       <td>1</td>
       <td>long message, word at offset 24 points to
           the actual message in shared memory</td>
     </tr>
     <tr valign="top">
       <td>bit 2</td>
       <td>0</td>
       <td>-</td>
     </tr>
     <tr valign="top">
       <td></td>
       <td>1</td>
       <td>message block is in the RMA and should be released
           by the receiver (long messages only)</td>
     </tr>
     </table>
   </td>
 </tr>
 <tr>
   <td>24</td>
   <td>command</td>
   <td>command-string or pointer to the command-string</td>
 </tr>
 </table>

 <p>
  Supported commands are:

 <p>
 <table width="99%" border="1">
 <colgroup span="1" width="100">
 <colgroup span="1">
 <tr>
   <td valign="top">Command</td>
   <td valign="top"><b>log</b></td>
 </tr> 
 <tr>
   <td valign="top">Syntax</td>
   <td valign="top">log &lt;string&gt;</td>
 </tr> 
 <tr>
   <td valign="top">Example</td>
   <td valign="top"><code>log CGI webcam cgi-script failed</code></td>
 </tr> 
 <tr>
   <td valign="top">Purpose</td>
   <td valign="top">write a string to the log file; the string should
       start with a short keyword indicating the type of log-entry;
       cgi-scripts using this command should always use the format
       <code>&quot;CGI&quot; &lt;cgi-script-title&gt; &lt;report&gt;</code>
       </td>
 </tr> 
 </table>

 <p>
 <table width="99%" border="1">
 <colgroup span="1" width="100">
 <colgroup span="1">
 <tr>
   <td valign="top">Command</td>
   <td valign="top"><b>closeall</b></td>
 </tr> 
 <tr>
   <td valign="top">Syntax</td>
   <td valign="top">closeall</td>
 </tr> 
 <tr>
   <td valign="top">Purpose</td>
   <td valign="top">close all open connections</td>
 </tr> 
 </table>
 <p>

 <table width="99%" border="1">
 <colgroup span="1" width="100">
 <colgroup span="1">
 <tr>
   <td valign="top">Command</td>
   <td valign="top"><b>flushcache</b></td>
 </tr> 
 <tr>
   <td valign="top">Syntax</td>
   <td valign="top">flushcache</td>
 </tr> 
 <tr>
   <td valign="top">Purpose</td>
   <td valign="top">flush the file- and report-caches</td>
 </tr> 
 </table>
 <p>

 <table width="99%" border="1">
 <colgroup span="1" width="100">
 <colgroup span="1">
 <tr>
   <td valign="top">Command</td>
   <td valign="top"><b>quitwhenidle</b></td>
 </tr> 
 <tr>
   <td valign="top">Syntax</td>
   <td valign="top">quitwhenidle</td>
 </tr> 
 <tr>
   <td valign="top">Purpose</td>
   <td valign="top">wait until there's no more active connections,
       then quit; used by <code>&lt;WebJames$Dir&gt;.Restart</code></td>
 </tr> 
 </table>
 <p>

 <table width="99%" border="1">
 <colgroup span="1" width="100">
 <colgroup span="1">
 <tr>
   <td valign="top">Command</td>
   <td valign="top"><b>clf</b></td>
 </tr> 
 <tr>
   <td valign="top">Syntax</td>
   <td valign="top">clf &lt;code&gt; &lt;bytes&gt; &lt;host&gt; % &lt;requestline&gt;</td>
 </tr> 
 <tr>
   <td valign="top">Example</td>
   <td valign="top"><code>clf 200 1234 elvis.graceland.com % GET /music.html HTTP/1.0</code></td>
 </tr> 
 <tr>
   <td valign="top">Purpose</td>
   <td valign="top">write a line to the <code>CLF</code> log file; the
       % is simply there to make parsing the command easier</td>
 </tr>
 <tr>
   <td valign="top">Comments</td>
   <td valign="top">Not supported in version 0.09</td>
 </tr>
 </table>



<p>
<h3>
<table bgcolor="#cccccc" width="99%"><tr><td>
<a name="cache">Cache</a>
</td></tr></table>
</h3>

  The cache is configured in the <a href="#config">config file</a>.<br>
  The following configuration options control the cache:

 <table>
 <col span="1" width="150">

 <tr>
 <td valign="top"><code>cacherefreshdelay</code></td>
 <td>this set maximum time (in minutes) that a file is cached; after
     the time has passed, the file is removed from the cache (the file
     may be cache again the next time it is requested).</td>
 </tr>

 <tr>
 <td valign="top"><code>cachesize</code></td>
 <td>this sets the cachesize in kbytes; the cache is kept in a dynamic
     area (if the OS supports this) or in the wimp-slot.</td>
 </tr>

 <tr>
 <td valign="top"><code>maxcachefilesize</code></td>
 <td>files larger than this value will never be cached.</td>
 </tr>

 </table>



<p>
<h3>
<table bgcolor="#cccccc" width="99%"><tr><td>
<a name="reports">Reports</a>
</td></tr></table>
</h3>

  When an http-request fails (eg. the requested object cannot be found),
 WebJames checks if the file <code>&lt;WebJames$Dir&gt;.Reports.XXX</code>
 exists. (<code>XXX</code> is replaced with the status-code for the
 failure, eg. 404 for <code>object not found</code>).

 <p>
  If the report-file doesn't exist, a standard report is returned to the
 client.

 <p>
  If the report-file exist, it will be returned to the client, after the
 keywords have been replaced by their values. The supported keywords are
 listed below; the value of the <code>%EMAIL%</code> keyword is set by
 the <code>webmaster</code>-entry in the <a href="#config">config file</a>.

 <p>
 <table width="90%" border="1">
 <colgroup span="1" width="50" align="center">
 <colgroup span="1" width="160">
 <colgroup span="1">
 <tr>
   <th valign="top">status code</th>
   <th valign="top"><b>meaning</b></th>
   <th valign="top"><b>keywords</b></th>
 </tr> 
 <tr>
   <td>204</td>
   <td>no content</td>
   <td>%EMAIL% %URL%</td>
 </tr> 
 <tr>
   <td>301</td>
   <td>moved</td>
   <td>%EMAIL% %URL% %NEWURL%</td>
 </tr> 
 <tr>
   <td>302</td>
   <td>moved temporarily</td>
   <td>%EMAIL% %URL% %NEWURL%</td>
 </tr> 
 <tr>
   <td>304</td>
   <td>not modified</td>
   <td>%EMAIL% %URL%</td>
 </tr> 
 <tr>
   <td>400</td>
   <td>bad request</td>
   <td>%EMAIL% %URL%</td>
 </tr> 
 <tr>
   <td>401</td>
   <td>unauthorized access</td>
   <td>%EMAIL% %URL%</td>
 </tr> 
 <tr>
   <td>403</td>
   <td>forbidden</td>
   <td>%EMAIL% %URL%</td>
 </tr> 
 <tr>
   <td>404</td>
   <td>not found</td>
   <td>%EMAIL% %URL%</td>
 </tr> 
 <tr>
   <td>500</td>
   <td>unexpected server error</td>
   <td>%EMAIL%</td>
 </tr> 
 <tr>
   <td>501</td>
   <td>not implemented</td>
   <td>%EMAIL% %URL% %METHOD%</td>
 </tr> 
 <tr>
   <td>503</td>
   <td>busy</td>
   <td>%EMAIL% %URL% %WHY%</td>
 </tr> 
 </table>

 <p>
 See the examples in <code>!WebJames.Reports</code>.



<p>
<h3>
<table bgcolor="#cccccc" width="99%"><tr><td>
<a name="improv">Things that need to be improved</a>
</td></tr></table>
</h3>

 <ul>
 <li>currently only supports the ANT/Acorn resolver
 <li>when a cgi-script fails, it should be possible for it to use the
    report-generating facilities in WebJames; eg. by use of a command
    like:<br>
    <code>report &lt;code&gt; &lt;socketno&gt; &lt;lines&gt; &lt;rmaaddr&gt;</code>
    (the rma block should hold &lt;lines&gt; lines; each line should be
    0-terminated and have the following format:
    <code>%KEYWORD%:value</code>).<br>
    <b>This has not yet been implemented...</b>
 <li>the ability to serve as a proxy would be nice!!!
 <li>cgi-lib doesn't handle POST requests
 <li>there's no provision for reverse dns when a cgi-script is called
 <li>cgi-lib doesn't handle the extended common log file format
 </ul>


<p>
<h3>
<table bgcolor="#cccccc" width="99%"><tr><td>
<a name="history">History</a>
</td></tr></table>
</h3>

<i>0.26 (19/10/2000)</i>

<ul>
  <li>attribute <code>defaultfile</code> can now take a list of files to look for
  <li>added support for the <code>SCRIPT_NAME</code>
      enviroment-variable when using 'redirected' cgi-scripts.
      This allows the <code>$PHP_SELF</code> variable to work in PHP scripts.
  <li>bugfix in leap year calculation
  <li>bugfix in assigning attributes - if a [/dir/] section was defined then the attributes for [/] were ignored for all files in dir
  <li>moved the site directory outside of !WebJames (perhaps the config and attributes need to move to Choices:?)
  <li>attributes can now be attr (space) value as well as attr = value
  <li>added support for <code>&lt;location&gt;</code> and <code>&lt;directory&gt;</code> sections in <a href="#attr">attributes</a> file
      (<code>&lt;files&gt;</code> to follow shortly)
  <li>added support for htaccess files
  <li>a new <a href="#attr">attribute</a> has been defined <code>errordocument</code>
  <li>changed value passed to Wimp_Initialise so it <i>might</i> work on RISC OS 3.10
</ul>


<i>0.25 (31/08/2000)</i>

<ul>
  <li>I (Alex Waugh) have now taken over the maintenance of WebJames
  <li>a couple of new <a href="#attr">attributes</a> have been defined:
      <ul>
      <li><code>allowed-filetypes</code>
      <li><code>forbidden-filetypes</code>
      </ul>
      these allow cgi-scripts to be executed only if their filetype is/isn't on the list,
      useful for keeping both PHP scripts and normal HTML in the same directory
</ul>


<i>0.24 (26/06/2000)</i>

<ul>
  <li>the various cgi-script related enviroment-variables are now set
      as literal strings and are set <em>every</em> time a CGI-script is
      executed, rather than just the first time
</ul>


<i>0.23 (19/12/1999)</i>

<ul>
  <li>fixed bugs which prevented CLF output from cgi-scripts and reports
</ul>


<i>0.22 (12/07/1999)</i>

<ul>
  <li>new attribute: <code>defaultfile</code> sets the name of the file to
      return when a request for a directory is received - this lets you
      return something else than <code>index.html</code>
  <li>WebJames now quits if it fails to bind the socket that listens for
      incoming connections
</ul>


<i>0.21 (24/06/1999)</i>

<ul>
  <li>when the server returns a <code>301 (moved)</code> or
      <code>302 (temporarily moved)</code> respons, the new URL is now
      absolute if possible (ie. if the <code>serverip</code> field in
      the config file is set)
</ul>


<i>0.20 (08/06/1999)</i>

<ul>
  <li>serious bug in <code>cache.c</code> fixed - when compiled with the
      <code>LOG</code> switch, WebJames crashed when loading a new version
      of an already cached file...
</ul>


<i>0.19 (06/06/1999)</i>

<ul>
  <li>tidied <code>stat.c</code>
  <li>fixed bug in <code>attributes.c</code> - spaces in <code>realm</code>s
      were removed...
  <li>some new <a href="#attr">attributes</a> have been defined:
      <ul>
      <li><code>more-attributes</code>
      <li><code>hidden</code>
      <li><code>nothidden</code>
      <li><code>ram-faster</code> (defined, but not yet implemented)
      <li><code>priority</code> (defined, but not yet implemented)
      </ul>
</ul>


<i>0.18 (16/05/1999)</i>

<ul>
  <li>added support for the <code>SERVER_ADMIN</code>
                        and <code>SERVER_PORT</code>
      enviroment-variables when using 'redirected' cgi-scripts
  <li>fixed a bug: <code>-put</code> and/or <code>-delete</code> arguments
      were not passed to 'webjames'-style cgi-scripts
  <li>the portnumber is now passed to 'webjames'-style cgi-scripts as
      part of the CLI-arguments (using <code>-port XX</code>)  BASIC
      cgi-lib updated to handle/ignore this
  <li>WebJames can now accept connections on multiple ports - simply
      specify a comma-seperated list of ports in the config-file
  <li>three new <a href="#attr">attributes</a> supported - if the
      <code>port</code>-attribute if defined for an URI, only request
      on the specifed port are accepted (this is only useful when
      WebJames is configured to listen on multiple ports); the
      <code>allowed-hosts</code> and <code>forbidden-hosts</code>
      attributes control which hosts can access the data
  <li>if the requested URI is a directory, a <code>301 Moved</code>
      reply is returned, with a <code>/</code> appended to the URI
  <li>if compiled with the <code>CASESENSITIVE</code> switch, URI matching
      is done case-sensitive.
</ul>


<i>0.17 (02/05/1999)</i>

<ul>
  <li>finally found a nice way to implement support for the <code>PUT</code>
      and <code>DELETE</code> request-methods
  <li>new <a href="#attr">attribute</a> supported - the
      <code>methods</code>-attribute defines which request-methods are
      allowed for an URI - this can be used to allow only <code>PUT</code>
      request to access the script defined by the <code>put-script</code>
      field in the <a href="#config">config file</a>
  <li><code>report_servererr()</code> added
</ul>


<i>0.16 (29/04/1999)</i>

<ul>
  <li>support for cookies when using 'redirected' cgi-scripts
</ul>


<i>0.15 (25/04/1999)</i>

<ul>
  <li>fixed bugs in <code>read.c</code>:<br>
      - an error was generated if WebJames <i>succeeded</i> in allocating
        a buffer for the body of a request!!<br>
      - failed to check when the entire request-body had been read<br>
  <li>fixed a couple of bugs relating to cgi-requests, <code>POST</code>
      now seems to work - or at least the few examples I've tried worked...
  <li>added <code>cgi-input</code> and <code>cgi-output</code> fields to
      the <a href="#config">config file</a> - these control the location of
      the spool-files used for redirected input/output to/from cgi-scripts
  <li><code>report_badrequest()</code> now replaces the <code>WHY</code>
      keyword in the report-file
  <li>added support for the <code>CONTENT_LENGTH</code>,
                            <code>CONTENT_TYPE</code>
      enviroment-variables when using 'redirected' cgi-scripts.
  <li>fixed bug in the BASIC cgi-lib - <code>CGI_MaxBytesPerSecond%</code>
      was set to 100 if WebJames specified <code>-bps 0</code>, ie. no limit 
</ul>


<i>0.14 (04/04/1999)</i>

<ul>
  <li>fixed bug in <code>cgi.c</code> (sometimes caused
       <code>QUERY_STRING</code> to be set to an incorrect value)
  <li>added support for the <code>SERVER_SOFTWARE</code>,
                            <code>SERVER_PORT</code>,
                            <code>SERVER_PROTOCOL</code>,
                            <code>SERVER_NAME</code>,
                            <code>PATH_TRANSLATED</code>,
                            <code>REMOTE_HOST</code>
      enviroment-variables when using 'redirected' cgi-scripts.
  <li>server ip-address/domainname can now be specified in the
      <a href="#config">config file</a>
  <li>fixed bugs in <code>resolve.c</code> so WebJames can now be
      compiled using the <code>-DANTRESOLVER</code> switch
</ul>


<i>0.13 (20/03/1999)</i>

<ul>
  <li>security-bug fixed - pasword-protection failed if the URI included
      arguments, eg. <code>/cgi-bin/query?q=whatsat</code>
</ul>


<i>0.12 (13/03/1999)</i>

<ul>
  <li>somehow <code>CR</code> and <code>LF</code> had been switched in
      <code>write.c</code> - although the exact same bug was fixed in
      v0.10b...
  <li>the <code>CLF</code> log wasn't rotated as specified in the
      <a href="#config">config file</a> and wasn't closed after the
      specified timeout
  <li>serious bug in the attributes-scanning-code fixed -  attributes
      were sometimes applied incorrectly (eg. the attributes for the
      file <code>/abc</code> were applied to the file <code>/abcde</code>)
  <li>when using 'redirect' cgi-scripts, WebJames writes
      <code>HTTP/1.0 200 OK</code> before outputting the file to the
      socket
</ul>


<i>0.11 (07/03/1999)</i>

<ul>
  <li>cgi-scripts that expect all output to go to the socket are now
      supported
  <li>the 'moved', 'access' and 'homedirs' database files have been
      dropped in favour of a much more flexible (and faster!) system
      where you can assign attributes (like password-protection,
      redirection, cacheability and more) to any UR - numerous minor
      and major changes to allow this... <em>this is still not fully
      tested yet</em>
  <li>MAJOR bug fixed - password-protection failed if you just changed the
      case of (any letter in) the URI; URIs are now case-insensitive - not
      perfect considering that many browsers assume otherwise, but for now
      it'll have to do
  <li><code>report_busy(connection)</code>   changed to
      <code>report_busy(connection, text)</code>
  <li>logfiles may be rotated either when they're too big or too old; the
      old logs can automatically be compressed
  <li>the duration for which logs are kept open after a write is now
      configurable
  <li>the maximum allowed size of a request can now be configured
  <li>the <code>connection</code> structure now has fields for the
      <i>User-Agent:</i> and <i>Referer:</i> lines from the
      request-header; these are now included in the <code>CLF</code> log
  <li>resolver handling moved to <code>resolve.c</code>
  <li>cache-heap handling moved to <code>cacheheap.c</code>
  <li><code>cacherefreshdelay</code> no longer used
  <li>rewritten to use OSLib... <em>hasn't yet been tested/compiled with
      the <code>-DANTRESOLVER</code> or <code>-DSYSLOG</code> flags</em>
</ul>


<i>0.10b (03/03/1999)</i>

<br>
  Thanks to Chris Bitmead
    <a href="mailto:chris.bitmead@bigfoot.com">
    &lt;chris.bitmead@bigfoot.com&gt;
    </a>:

<ul>
  <li>serious bug in <code>write.c</code> fixed - <code>CR LF</code>
      had been switched, so many browsers failed to read the header...
</ul>


<i>0.10 (07/02/1999)</i>

<ul>
  <li><code>quitwhenidle</code> command added and
      <code>&lt;WebJames$Dir&gt;.Restart</code> added -
      to kill and restart WebJames, simply double click on the WebJames
      icon in a filer window
  <li>cgi-lib has grown so big that it is now necessary to use
      <code>END=&18000</code>
  <li><code>report_badrequest(connection)</code>   changed to
      <code>report_badrequest(connection, text)</code>
  <li>if a cgi-script is password-protected, the username is passed to the
      script (as <code>-user &lt;username&gt;</code>)
  <li>rather than specifying a single username:password pair in the access
      file, you may now specify a file with any number of username:password
      pairs; the cgi-script <code>pwd</code> and the database file
      <code>users</code> demonstrate this
  <li>loglevel can now be set from the <a href="#config">config file</a>
  <li>HTTP version number is now read as major.minor
  <li>lots of bugs in and around <code>report.c</code> fixed
  <li>tidied the code for handling unimplemented request methods
  <li>cgi-lib has been updated to support the new <code>clf</code> command;
      it now also has support for sending <i>long</i> commands to WebJames;
      some small bugs fixed
  <li>tested the new <code>clf</code> command - works fine; WebJames no
      longer generates a clf-log-entry when a request results in a
      cgi-script being executed
  <li>the <code>!Run</code> file now checks for the presence of the MimeMap
      module, although not quite as extensively as JF suggested...
</ul>


<i>0.09 (03/02/1999)</i>

<ul>
  <li>added (but not yet tested) the new <CODE>clf</CODE> command
</ul>

  Thanks to Justin Fletcher
    <a href="mailto:networking@thevillage.ndirect.co.uk">
    &lt;networking@thevillage.ndirect.co.uk&gt;
    </a>:

<ul>
  <li><code>-DSYSLOG</code> can now be used to build a version that uses
      <code>SysLog</code>
  <li>logging levels are now reversed - high numbers are lower priority
      type messages; <code>LOGLEVEL_NEVER</code> is now the lowest level
      you can use
  <li>internal mimemap database deleted, and MimeMap module used instead
  <li>time conversion fixed
</ul>


<i>0.08 (31/01/1999)</i>

<ul>
  <li>released...
</ul>



<p>
<h3>
<table bgcolor="#cccccc" width="99%"><tr><td>
<a name="Notes">Notes</a>
</td></tr></table>
</h3>

<h5>PHP</h5>

  WebJames works well with the <a href="http://www.ecs.soton.ac.uk/~ajw498/internet/php/">RISC OS port of PHP</a><br>
  With the default configuration you can put PHP scripts anywhere where you would put normal HTML.

<p>

<h5>Recompiling WebJames</h5>

  The pre-compiled version of WebJames is usually compiled with the
 <code>LOG</code> switch <i>on</i> and the <code>SYSLOG</code> and
 <code>ANTRESOLVER</code> switches <i>off</i>.

 <p>
  If you want to recompile WebJames, you should notice that the source
 is not written in 100% ANSI C. It has been written so that is doesn't
 generate any warnings (or errors) on Acorns C v5, but as it uses
 <code>//</code> for comments, it may fail on other compilers.

 <p>
  The <code>LOG</code> switch enables logging.

 <p>
  The <code>SYSLOG</code> switch causes log information to be output to
 <code>!SysLog</code> instead of to the logfile defined in the config-file.

 <p>
  The <code>ANTRESOLVER</code> switch enables reverse-DNS using the
 ANT/Acorn resolver module interface.

 <p>
  The <code>CASESENSITIVE</code> switch causes filename matching to be
 case-sensitive, however, as FileSwitch is case-insensitive, it should
 only be used when the <em>entire</em> website is stored on a
 non-FileSwitch filing-system. <em>The use of this switch has not been
 fully tested yet.</em>


</body>
</html>

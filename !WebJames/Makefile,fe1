
# Makefile for WebJames the web server

CC            = cc

MemCheck = MemCheck.cc

# possible flags:
# ANTRESOLVER     use the ANT resolver module API for reverse DNS
# LOG             enable logging
# SYSLOG          use SysLog instead of internal log
Flags         = -DLOG
#Flags         = -DANTRESOLVER -DLOG -DSYSLOG

#CCFlags       = -c -throwback -depend !Depend -IC: -strict -fah -Otime $(Flags)
CCFlags       = -c -throwback -depend !Depend -IC: -g -strict -fah $(Flags) -Wg
LinkFlags     = -d -o $@

Libs          = C:OSLib.o.OSLib C:o.Stubs C:o.socklib MemCheck:o.MC C:regex.a.libregex
Objects       = main.o webjames.o ip.o stat.o report.o write.o openclose.o read.o cache.o coding.o mimemap.o attributes.o resolve.o cacheheap.o handler.o staticcontent.o webjamesscript.o cgiscript.o sendasis.o content.o serverparsed.o

!RunImage:    $(Objects)
	Link $(Linkflags) $(Objects) $(Libs)
	SetType $@ Absolute
#	Squeeze -f -v !RunImage

.c.o:
	$(MemCheck) $(CC) $(CCFlags) $< -o $@

# Dynamic dependencies:
o.serverparsed: c.serverparsed C:h.stdio C:h.stdlib C:h.string C:h.ctype C:h.time C:h.swis C:h.kernel C:oslib.h.osfile C:oslib.h.types C:oslib.h.os C:oslib.h.fileswitch C:regex.h.regex h.webjames h.ip h.openclose h.webjames h.write h.stat h.attributes C:regex.h.regex h.report h.content h.cache h.handler h.staticcontent h.cgiscript h.serverparsed

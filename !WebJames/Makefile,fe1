
# Makefile for WebJames the web server

CC            = cc

MemCheck = MemCheck.cc

# possible flags:
# ANTRESOLVER     use the ANT resolver module API for reverse DNS
# LOG             enable logging
# SYSLOG          use SysLog instead of internal log
Flags         = -DLOG
#Flags         = -DANTRESOLVER -DLOG -DSYSLOG

#CCFlags       = -c -throwback -depend !Depend -IC: -strict -fah -Otime $(Flags)
CCFlags       = -c -throwback -depend !Depend -IC: -g -strict -fah $(Flags) -Wg
LinkFlags     = -o $@

Libs          = C:OSLib.o.OSLib C:o.Stubs C:o.socklib MemCheck:o.MC C:regex.a.libregex
Objects       = main.o webjames.o ip.o stat.o report.o write.o openclose.o read.o cache.o coding.o mimemap.o attributes.o resolve.o cacheheap.o handler.o staticcontent.o webjamesscript.o cgiscript.o sendasis.o content.o

!RunImage:    $(Objects)
	drLink -d $(Linkflags) $(Objects) $(Libs)
#	Squeeze -f -v !RunImage

.c.o:
	$(MemCheck) $(CC) $(CCFlags) $< -o $@

# Dynamic dependencies:
o.cache: c.cache MemCheck:h.MemCheck C:h.stddef C:h.stdio C:h.stdarg C:h.stdio C:h.stdlib C:h.string C:h.time C:oslib.h.os C:oslib.h.types C:oslib.h.wimp C:oslib.h.osspriteop C:oslib.h.font C:oslib.h.fileswitch C:oslib.h.osfile C:oslib.h.osfscontrol h.webjames h.cache h.write h.cacheheap h.stat h.mimemap

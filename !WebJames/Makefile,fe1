
# Makefile for WebJames the web server

CC            = cc

#MemCheck = MemCheck.cc

# possible flags:
# ANTRESOLVER     use the ANT resolver module API for reverse DNS
# LOG             enable logging
# SYSLOG          use SysLog instead of internal log
Flags         = -DLOG
#Flags         = -DANTRESOLVER -DLOG -DSYSLOG

CCFlags       = -c -throwback -depend !Depend -IC: -strict -fah -Otime $(Flags)
#CCFlags       = -c -throwback -depend !Depend -IC: -g -strict -fah $(Flags) -Wg
LinkFlags     = -o $@

Libs          = C:OSLib.o.OSLib C:o.Stubs C:o.socklib MemCheck:o.MC C:regex.a.libregex
Objects       = main.o webjames.o ip.o stat.o report.o write.o openclose.o read.o cache.o coding.o mimemap.o attributes.o resolve.o cacheheap.o handler.o staticcontent.o webjamesscript.o cgiscript.o sendasis.o

!RunImage:    $(Objects)
	Link $(Linkflags) $(Objects) $(Libs)
	Squeeze -f -v !RunImage

.c.o:
	$(MemCheck) $(CC) $(CCFlags) $< -o $@

# Dynamic dependencies:
o.coding: c.coding h.coding
o.handler: c.handler C:h.stdio C:h.stdlib C:h.string C:h.time h.webjames h.handler h.report h.staticcontent h.sendasis h.cgiscript h.webjamesscript
o.main: c.main C:oslib.h.os C:oslib.h.types C:oslib.h.wimp C:oslib.h.osspriteop C:oslib.h.font h.main h.webjames h.global
o.webjames: c.webjames C:oslib.h.os C:oslib.h.types C:oslib.h.osmodule C:oslib.h.osfscontrol C:oslib.h.fileswitch C:oslib.h.territory h.global h.cache h.webjames h.ip h.stat h.report h.write h.read h.openclose h.attributes C:regex.h.regex h.resolve h.handler
o.ip: c.ip C:oslib.h.socket C:oslib.h.types C:oslib.h.os h.ip
o.stat: c.stat C:oslib.h.os C:oslib.h.types h.webjames h.stat h.ip
o.report: c.report h.webjames h.cache h.stat h.ip h.openclose h.report h.write h.attributes C:regex.h.regex h.handler
o.write: c.write C:oslib.h.osfile C:oslib.h.types C:oslib.h.os C:oslib.h.fileswitch C:oslib.h.osgbpb C:oslib.h.osfscontrol h.webjames h.cache h.ip h.openclose h.stat h.attributes C:regex.h.regex h.report h.write h.mimemap h.handler
o.openclose: c.openclose h.cache h.webjames h.ip h.attributes C:regex.h.regex h.stat h.openclose h.resolve
o.read: c.read h.webjames h.attributes C:regex.h.regex h.stat h.ip h.read h.report h.write h.coding
o.cache: c.cache C:oslib.h.os C:oslib.h.types C:oslib.h.wimp C:oslib.h.osspriteop C:oslib.h.font C:oslib.h.fileswitch C:oslib.h.osfile C:oslib.h.osfscontrol h.webjames h.cache h.write h.cacheheap h.stat h.mimemap
o.mimemap: c.mimemap h.mimemap C:h.kernel
o.attributes: c.attributes h.webjames h.write h.attributes C:regex.h.regex h.stat h.handler C:oslib.h.osfscontrol C:oslib.h.types C:oslib.h.os C:oslib.h.fileswitch
o.resolve: c.resolve h.stat h.webjames h.resolve h.ip
o.cacheheap: c.cacheheap C:h.swis C:h.kernel h.cacheheap
o.staticcontent: c.staticcontent h.webjames h.ip h.openclose h.stat h.report h.cache h.staticcontent
o.webjamesscript: c.webjamesscript C:oslib.h.os C:oslib.h.types C:oslib.h.osfile C:oslib.h.fileswitch C:oslib.h.osfscontrol C:oslib.h.osmodule C:oslib.h.wimp C:oslib.h.osspriteop C:oslib.h.font h.webjames h.webjamesscript h.openclose h.report h.stat h.ip h.write
o.cgiscript: c.cgiscript C:oslib.h.os C:oslib.h.types C:oslib.h.osfile C:oslib.h.fileswitch C:oslib.h.osfscontrol C:oslib.h.osmodule C:oslib.h.wimp C:oslib.h.osspriteop C:oslib.h.font h.webjames h.cgiscript h.openclose h.report h.stat h.ip h.write h.handler
o.sendasis: c.sendasis h.webjames h.report h.cache h.sendasis
